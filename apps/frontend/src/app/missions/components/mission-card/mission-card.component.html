<div class="mission-card">
  <!-- Mission Media -->
  @if (mission.media) {
  <div class="mission-media">
    <img
      [src]="getMediaUrl(mission.media)"
      [alt]="mission.media.alt || mission.name"
      class="media-image"
      (error)="onImageError($event)"
    />
  </div>
  }

  <!-- Mission Content -->
  <div class="mission-content">
    <div class="mission-header">
      <h2 class="mission-name">{{ mission.name }}</h2>
      @if (hasJoined) {
      @if (playerState === 'completed') {
      <div class="completed-label">
        <mat-icon>check_circle</mat-icon>
        <span>Mission Completed</span>
      </div>
      } @else {
      <div class="playing-label">
        <mat-icon>play_circle</mat-icon>
        <span>Mission Is Playing</span>
      </div>
      }
      } @else if (showPlayButton) {
      <button
        mat-raised-button
        color="primary"
        (click)="onPlayMission($event)"
        class="play-button"
        [disabled]="isLoading"
      >
        <mat-icon>play_arrow</mat-icon>
        {{ isLoading ? 'Starting...' : 'Play Mission' }}
      </button>
      }
    </div>

    @if (showGames) {
    <!-- Games by Ability -->
    <div class="mission-abilities">
      <h3 class="abilities-title">Games by Ability:</h3>

      <div class="abilities-list">
        @for (gameData of getExistingGames(); track gameData.game.slug) {
        <div class="ability-item {{ gameData.abilityClass }}">
          <span class="ability-icon">{{ gameData.abilityIcon }}</span>
          <span class="game-name">{{ gameData.game.name }}</span>
        </div>
        }
      </div>
    </div>
    }
  </div>
</div>
